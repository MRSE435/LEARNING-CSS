<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Striver Code Beautifier — Offline</title>
  <style>
    :root{--bg:#0f1724;--panel:#0b1220;--muted:#98a0b3;--accent:#7c3aed;--glass: rgba(255,255,255,0.03);--light:#f8fafc}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{background:linear-gradient(180deg,#071025 0%, #071126 60%);color:var(--light);display:flex;flex-direction:column}
    header{display:flex;gap:12px;align-items:center;padding:18px 22px;border-bottom:1px solid rgba(255,255,255,0.03)}
    header h1{font-size:18px;margin:0;font-weight:600}
    .container{display:grid;grid-template-columns:1fr 420px;gap:16px;padding:18px}
    .card{background:var(--panel);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03)}
    .editor{display:flex;flex-direction:column;height:calc(100vh - 140px)}
    .toolbar{display:flex;gap:8px;align-items:center;margin-bottom:8px}
    select,input,button{background:var(--glass);border:1px solid rgba(255,255,255,0.04);padding:8px 10px;border-radius:8px;color:var(--light)}
    button{cursor:pointer}
    textarea{flex:1;width:100%;resize:none;border-radius:8px;padding:12px;background:#071525;color:var(--light);font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,monospace;font-size:13px;border:1px solid rgba(255,255,255,0.03)}
    .right{display:flex;flex-direction:column;height:calc(100vh - 140px)}
    .preview{flex:1;overflow:auto;padding:12px;border-radius:8px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.02)}
    pre{white-space:pre-wrap;word-break:break-word;font-family:ui-monospace,Menlo,monospace;font-size:13px}
    .small{font-size:12px;color:var(--muted)}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    .actions{display:flex;gap:8px;margin-left:auto}
    footer{padding:10px 18px;color:var(--muted);font-size:13px}
    .badge{background:linear-gradient(90deg,#6b21a8,#8b5cf6);padding:6px 10px;border-radius:999px;font-weight:600}
    /* simple syntax highlight tokens */
    .tok-key{color:#7dd3fc;font-weight:600}
    .tok-kw{color:#67e8f9;font-weight:700}
    .tok-num{color:#fca5a5}
    .tok-str{color:#86efac}
    .tok-cmt{color:#94a3b8;font-style:italic}
    .row{display:flex;gap:8px;align-items:center}
    .split{display:flex;gap:12px}
    @media (max-width:980px){.container{grid-template-columns:1fr;}.right{order:2}} 
  </style>
</head>
<body>
  <header>
    <div class="badge">Striver Beautifier</div>
    <h1>Turn your daily code into a beautiful offline web app — paste, style, save, run (JS)</h1>
  </header>

  <div class="container">
    <section class="card editor">
      <div class="toolbar">
        <div class="row">
          <label class="small" for="lang">Language</label>
          <select id="lang">
            <option value="cpp">C++</option>
            <option value="c">C</option>
            <option value="java">Java</option>
            <option value="py">Python</option>
            <option value="js">JavaScript</option>
          </select>
        </div>

        <div class="controls">
          <button id="beautify">Beautify</button>
          <button id="highlight">Highlight</button>
          <button id="clear">Clear</button>
          <button id="saveLocal">Save (Local)</button>
          <button id="loadLocal">Load (Local)</button>
        </div>

        <div class="actions">
          <button id="download">Download</button>
          <button id="runJS">Run (JS only)</button>
          <button id="themeToggle">Toggle Theme</button>
        </div>
      </div>

      <textarea id="code" placeholder="Paste your code here..." spellcheck="false"></textarea>

      <div style="margin-top:8px;display:flex;justify-content:space-between;align-items:center">
        <div class="small">Autosave: <span id="autosave">ON</span></div>
        <div class="small">Status: <span id="status">Ready</span></div>
      </div>
    </section>

    <aside class="card right">
      <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px">
        <strong>Preview & Tools</strong>
        <div class="small">(syntax highlight, download, run)</div>
      </div>

      <div class="preview" id="preview"><pre id="out">Paste code and click <strong>Highlight</strong></pre></div>

      <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
        <input type="text" id="filename" placeholder="filename (example: solution.cpp)" style="flex:1;padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.03);color:var(--light)">
        <button id="download2">Save File</button>
      </div>

      <div style="margin-top:10px;font-size:13px;color:var(--muted)">
        Tips: 1) Use the language dropdown so highlighter knows keywords. 2) Run is only for JavaScript code (it executes inside the browser). 3) Save to localStorage to keep daily work.
      </div>
    </aside>
  </div>

  <footer class="card" style="margin:12px">Made for you — paste your daily codes and I will turn them into beautiful offline pages. Want a feature (themes, prettier, CodeMirror)? Tell me and I'll improve it.</footer>

<script>
// tiny utility functions
const $ = sel => document.querySelector(sel);
const codeEl = $('#code');
const out = $('#out');
const langSel = $('#lang');
const status = $('#status');
let dark = true;

// basic keyword lists for highlighting (small sets)
const KEYWORDS = {
  cpp: ['int','long','short','float','double','if','else','for','while','return','struct','class','public','private','void','const','static','new','delete','using','namespace','switch','case','break','continue'],
  c: ['int','long','short','float','double','if','else','for','while','return','struct','goto','typedef','const'],
  java: ['int','long','short','float','double','if','else','for','while','return','class','public','private','protected','static','void','new','import','package','extends','implements'],
  py: ['def','return','if','elif','else','for','while','import','from','class','pass','in','and','or','not','lambda','with','as'],
  js: ['function','return','var','let','const','if','else','for','while','new','class','import','from','export','console','log']
};

function escapeHtml(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}

function simpleHighlight(code, lang){
  let s = escapeHtml(code);
  // comments
  if(lang === 'py'){
    s = s.replace(/#.*/g, m => `<span class="tok-cmt">${m}</span>`);
  } else {
    s = s.replace(/\/\/.*$/gm, m => `<span class="tok-cmt">${m}</span>`); // single line
    s = s.replace(/\/\*[\s\S]*?\*\//g, m => `<span class="tok-cmt">${escapeHtml(m)}</span>`); // block
  }
  // strings
  s = s.replace(/("[^"]*"|'[^']*')/g, m => `<span class="tok-str">${m}</span>`);
  // numbers
  s = s.replace(/\b(\d+\.?\d*|0x[0-9A-Fa-f]+)\b/g, m => `<span class="tok-num">${m}</span>`);
  // keywords
  const kws = KEYWORDS[lang] || [];
  for(const kw of kws){
    const re = new RegExp('\\b'+kw+'\\b','g');
    s = s.replace(re, `<span class="tok-kw">${kw}</span>`);
  }
  return s;
}

// Beautify (very simple): fix indentation for braces for C-like languages
function beautify(code, lang){
  if(lang === 'py'){
    // for python, just trim trailing spaces
    return code.split('\n').map(l=>l.replace(/\s+$/,'')).join('\n');
  }
  const lines = code.replace(/\t/g,'    ').split('\n');
  let indent = 0;
  const out = [];
  for(let raw of lines){
    let line = raw.trim();
    if(line === ''){ out.push(''); continue; }
    // decrease on closing brace at start
    if(/^\}/.test(line) || /^\)\s*;?/.test(line) && line.endsWith('}')){ indent = Math.max(0, indent-1); }
    out.push('    '.repeat(indent) + line);
    // increase if line ends with opening brace or ends with ':' for python-like blocks
    if(/\{\s*$/.test(line) || /\b(if|for|while|else|switch|class|struct|try|catch)\b.*:\s*$/.test(line) || /:\s*$/.test(line)){
      indent++;
    }
  }
  return out.join('\n');
}

// UI bindings
$('#highlight').addEventListener('click', ()=>{
  const code = codeEl.value;
  const lang = langSel.value;
  if(!code){ status.textContent = 'No code to highlight'; return; }
  out.innerHTML = simpleHighlight(code, lang);
  status.textContent = 'Highlighted';
});

$('#beautify').addEventListener('click', ()=>{
  const lang = langSel.value;
  codeEl.value = beautify(codeEl.value, lang);
  status.textContent = 'Beautified';
});

$('#clear').addEventListener('click', ()=>{ codeEl.value=''; out.textContent=''; status.textContent='Cleared'; });

$('#saveLocal').addEventListener('click', ()=>{
  const key = 'striver_daily_code_'+langSel.value;
  localStorage.setItem(key, codeEl.value);
  status.textContent = 'Saved to localStorage';
});

$('#loadLocal').addEventListener('click', ()=>{
  const key = 'striver_daily_code_'+langSel.value;
  const v = localStorage.getItem(key)||'';
  codeEl.value = v;
  status.textContent = v? 'Loaded from localStorage':'No saved code found';
});

$('#download').addEventListener('click', ()=>{
  const name = $('#filename').value || 'solution.' + (langSel.value==='py'?'py': langSel.value==='js'?'js': (langSel.value==='java'?'java':'cpp'));
  const blob = new Blob([codeEl.value], {type:'text/plain'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = name; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  status.textContent = 'Downloaded ' + name;
});

$('#download2').addEventListener('click', ()=>{ $('#download').click(); });

// Run JS code safely (basic sandbox)
$('#runJS').addEventListener('click', ()=>{
  if(langSel.value !== 'js'){ status.textContent = 'Switch to JavaScript to run code'; return; }
  const userCode = codeEl.value;
  try{
    // capture console.log
    const logs = [];
    const oldLog = console.log;
    console.log = function(){ logs.push(Array.from(arguments).join(' ')); oldLog.apply(console, arguments); }
    // run
    const fn = new Function(userCode);
    fn();
    console.log = oldLog;
    out.innerHTML = logs.length? ('<div class="small">Console output:</div><pre>'+escapeHtml(logs.join('\n'))+'</pre>') : '<div class="small">Executed (no console output)</div>';
    status.textContent = 'JS executed';
  }catch(e){ out.innerHTML = '<div class="small">Error:</div><pre>'+escapeHtml(e.toString())+'</pre>'; status.textContent='Runtime Error'; }
});

// autosave every 10s
setInterval(()=>{
  const key = 'striver_autosave_'+langSel.value;
  localStorage.setItem(key, codeEl.value);
  $('#autosave').textContent = 'ON';
},10000);

// load autosave on start
window.addEventListener('load', ()=>{
  const key = 'striver_autosave_'+langSel.value;
  const v = localStorage.getItem(key);
  if(v) codeEl.value = v;
});

// change lang reloads preview from autosave
langSel.addEventListener('change', ()=>{
  const key = 'striver_autosave_'+langSel.value;
  const v = localStorage.getItem(key);
  codeEl.value = v||'';
  out.textContent = '';
  status.textContent = 'Language set to '+langSel.value;
});

// theme toggle (simple)
$('#themeToggle').addEventListener('click', ()=>{
  dark = !dark;
  if(!dark){ document.documentElement.style.setProperty('--bg','#f7fafc'); document.documentElement.style.setProperty('--panel','#ffffff'); document.documentElement.style.setProperty('--light','#081126'); document.documentElement.style.setProperty('--muted','#334155'); }
  else{ document.documentElement.style.removeProperty('--bg'); document.documentElement.style.removeProperty('--panel'); document.documentElement.style.removeProperty('--light'); document.documentElement.style.removeProperty('--muted'); }
});

// helper escape for displaying
function escapeHtml(s){ return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

</script>
</body>
</html>
